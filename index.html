<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Digital Democracy</title>
    <link rel="stylesheet" href="src/css/styles.css">
    <!-- GDS Transport font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo" style="display: flex; align-items: center;">
                <div style="background-color: white; padding: 0.5rem; border-radius: 4px;">
                    <img src="src/images/logo.svg" alt="D³ Logo" style="height: 40px;">
                </div>
                <span style="color: white; margin-left: 1rem; font-weight: 600;">Direct Digital Democracy</span>
            </div>
            <ul class="nav-links">
                <li><a href="#about">About</a></li>
                <li><a href="#donate">Donate</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <h1>Democratic Power In Your Hands</h1>
            <p>Build a citizen owned app to better instruct our elected politcal leaders</p>
            <a href="#donate" class="govuk-button">I support this</a>
        </section>

        <section id="about" class="govuk-section">
            <h2>About The App</h2>
            <p>Direct Digital Democracy brings together experts who have protected your health and finance data from continual cyber attacks, made it easier for you to work with public sector through Gov.uk and NHS.Uk and built some of the most successful apps to help with your everyday lives. Now they would like your support to put democracy in all our hands</p>
        </section>

        <section class="govuk-section" style="background-color: #f8f8f8; padding: 3rem 5%;">
            <div class="govuk-grid">
                <div class="govuk-grid-column-two-thirds">
                    <h2 style="margin-bottom: 2rem;">First a simple question:</h2>
                    <div class="govuk-card" style="background-color: white; padding: 2rem;">
                        <h3 style="color: var(--coral-primary); margin-bottom: 1.5rem;">What issue would you want direct political influence over?</h3>
                        <form id="feedback-form" style="margin-top: 2rem;">
                            <div style="margin-bottom: 1.5rem;">
                                <textarea id="influence" name="influence" rows="4" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); font-family: inherit; font-size: 1rem;" required autocomplete="off"></textarea>
                            </div>
                            <div style="margin-bottom: 1.5rem;">
                                <label for="email" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Email address:</label>
                                <input type="email" id="email" name="email" style="width: 100%; padding: 0.75rem; border: 2px solid var(--border-color); font-family: inherit; font-size: 1rem;" required placeholder="Your email" autocomplete="email">
                            </div>
                            <button type="submit" class="govuk-button" style="margin-top: 1rem;">
                                Submit
                            </button>
                            <div id="form-success" style="display: none; color: #00703C; background-color: #F3F9F5; padding: 1rem; margin-top: 1rem; border-left: 5px solid #00703C;">
                                Thank you for your submission! We value your input.
                            </div>
                            <div id="form-error" style="display: none; color: #D4351C; background-color: #FEF7F7; padding: 1rem; margin-top: 1rem; border-left: 5px solid #D4351C;">
                                Sorry, there was an error submitting your response. Please try again later.
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <section id="donate" class="govuk-section" style="background-color: var(--coral-bg); padding: 4rem 5%;">
            <div class="govuk-grid">
                <div class="govuk-grid-column-two-thirds">
                    <h2>Support Our Mission</h2>
                    <p class="govuk-body" style="font-size: 1.25rem; margin-bottom: 2rem;">Help build a more democratic future. Your contribution will directly support the development of an app that will enable more citizens to participate in democratic decision-making.</p>
                    <div class="govuk-card" style="background-color: white; padding: 2rem; margin-bottom: 2rem;">
                        <h3>Why Donate?</h3>
                        <ul class="govuk-list">
                            <li>Support open-source development of democratic tools</li>
                            <li>Help maintain and improve our secure voting system</li>
                            <li>Enable more communities to adopt direct democracy</li>
                            <li>Contribute to a more transparent and participatory future</li>
                        </ul>
                    </div>
                    <div class="govuk-card" style="background-color: white; padding: 2rem; margin-bottom: 2rem; text-align: center;">
                        <h3 style="color: var(--coral-primary); margin-bottom: 1.5rem;">Ready to Support Our Mission?</h3>
                        <p style="font-size: 1.25rem; margin-bottom: 2rem;">Your contribution will help us build a more democratic future.</p>
                        <a href="https://www.crowdfunder.co.uk/p/ddd" 
                           class="govuk-button" 
                           style="font-size: 1.25rem; padding: 1rem 2rem;"
                           target="_blank"
                           rel="noopener noreferrer">
                            <i class="fas fa-heart" style="margin-right: 0.5rem;"></i> 
                            Donate Now
                            <i class="fas fa-external-link-alt" style="margin-left: 0.5rem; font-size: 0.8em;"></i>
                        </a>
                        <p style="margin-top: 1rem; color: var(--text-secondary);">
                            Opens in a new tab - Secure payment via Crowdfunder
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer id="contact">
        <div class="footer-content">
            <p>© 2024 Direct Digital Democracy. All rights reserved.</p>
            <div class="social-links">
                <a href="#" class="social-link"><i class="fab fa-github"></i> GitHub</a>
                <a href="#" class="social-link"><i class="fas fa-envelope"></i> Contact</a>
            </div>
        </div>
    </footer>

    <script src="src/js/main.js"></script>
    
    <!-- Direct form handler script -->
    <script>
        // Wait for the document to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Direct form handler script loaded');
            
            // Get the form element
            const form = document.getElementById('feedback-form');
            
            if (form) {
                console.log('Form found by direct handler');
                
                // Add submit event listener
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('Form submitted via direct handler');
                    
                    // Get form values
                    const influence = document.getElementById('influence').value;
                    const email = document.getElementById('email').value;
                    
                    // Show thank you message directly
                    form.innerHTML = `
                        <div style="text-align: center; padding: 2rem 0;">
                            <div style="font-size: 3rem; color: #00703C; margin-bottom: 1rem;">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <h3 style="color: #00703C; margin-bottom: 1rem;">Thank You!</h3>
                            <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
                                We've received your submission about what you'd like direct influence over.
                            </p>
                            <p style="font-size: 1.1rem; margin-bottom: 1.5rem;">
                                Your input helps us shape a better democratic future.
                            </p>
                            <button type="button" id="submit-another-direct" class="govuk-button" style="margin-top: 1rem;">
                                Submit Another Response
                            </button>
                        </div>
                    `;
                    
                    // API submission (will still happen in the background)
                    fetch('https://ddd-form-api-dc0c7b285f94.herokuapp.com/api/submit-form', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        mode: 'cors',
                        body: JSON.stringify({
                            influence: influence,
                            email: email
                        }),
                    }).then(response => {
                        console.log('API response from direct handler:', response.status);
                    }).catch(error => {
                        console.error('API error from direct handler:', error);
                    });
                    
                    // Add event listener for the "submit another" button
                    setTimeout(function() {
                        const reloadButton = document.getElementById('submit-another-direct');
                        if (reloadButton) {
                            reloadButton.addEventListener('click', function() {
                                window.location.reload();
                            });
                        }
                    }, 100);
                });
            } else {
                console.error('Form not found by direct handler');
            }
        });
    </script>
</body>
</html>
